<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>介电之窗——平行板电容器物理原理交互可视化</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-svg.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        secondary: '#36BFFA',
                        accent: '#722ED1',
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .极板-正极 {
                background-color: #FF4D4F;
            }
            .极板-负极 {
                background-color: #1890FF;
            }
            .电场线 {
                stroke: #165DFF;
                stroke-width: 1.5;
                stroke-dasharray: 5, 3;
                transition: all 0.3s ease;
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <!-- 标题区域 -->
        <header class="text-center mb-8">
            <h1 class="text-[clamp(1.8rem,4vw,2.5rem)] font-bold text-gray-800">介电之窗——平行板电容器物理原理交互可视化</h1>
            <p class="text-gray-600 mt-2">基于高斯定理与电容公式的交互演示 | 参数可调 · 实时可视化</p>
        </header>

        <!-- 物理原理说明 -->
        <section class="bg-white rounded-xl shadow-md p-6 mb-8">
            <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                <i class="fa-solid fa-book mr-2 text-primary"></i> 物理原理与定理
            </h2>
            <ul class="space-y-3 text-gray-700">
                <li class="flex items-start">
                    <i class="fa-solid fa-check-circle text-primary mt-1 mr-2"></i>
                    <span><strong>高斯定理</strong>：通过任意闭合曲面的电通量等于该曲面所包围的所有电荷的代数和除以\( \varepsilon_0 \)，即\( \oint \vec{E} \cdot d\vec{S} = \frac{Q_{enc}}{\varepsilon_0} \)。用于推导平行板间电场强度\( E = \frac{\sigma}{\varepsilon_0} \)（\( \sigma \)为极板电荷面密度）。</span>
                </li>
                <li class="flex items-start">
                    <i class="fa-solid fa-check-circle text-primary mt-1 mr-2"></i>
                    <span><strong>电容公式</strong>：平行板电容器的电容\( C = \frac{\varepsilon S}{d} \)，其中\( \varepsilon \)为介电常数（\( \varepsilon = \varepsilon_r \varepsilon_0 \)，\( \varepsilon_r \)为相对介电常数），\( S \)为极板面积，\( d \)为极板间距。</span>
                </li>
                <li class="flex items-start">
                    <i class="fa-solid fa-check-circle text-primary mt-1 mr-2"></i>
                    <span><strong>电场分布</strong>：忽略边缘效应时，极板间电场均匀，大小为\( E = \frac{U}{d} = \frac{Q}{\varepsilon S} \)；极板外电场相互抵消，强度为0。</span>
                </li>
            </ul>
        </section>

        <!-- 交互控制与可视化区域 -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- 交互控制区 -->
            <div class="bg-white rounded-xl shadow-md p-6 lg:col-span-1">
                <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                    <i class="fa-solid fa-sliders mr-2 text-primary"></i> 参数交互控制
                </h2>
                <div class="space-y-6">
                    <!-- 极板面积 -->
                    <div>
                        <label for="plate-area" class="block text-gray-700 mb-2">极板面积 \( S \) (m²)</label>
                        <input type="range" id="plate-area" min="0.001" max="0.05" step="0.001" value="0.02" 
                               class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                               oninput="updateParams('area', this.value)" onchange="updateParams('area', this.value)">
                        <div class="flex justify-between text-sm text-gray-500 mt-1">
                            <span>0.001</span>
                            <span id="area-display">0.02</span>
                            <span>0.05</span>
                        </div>
                    </div>

                    <!-- 极板间距 -->
                    <div>
                        <label for="plate-distance" class="block text-gray-700 mb-2">极板间距 \( d \) (m)</label>
                        <input type="range" id="plate-distance" min="0.0001" max="0.01" step="0.0001" value="0.005" 
                               class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                               oninput="updateParams('distance', this.value)" onchange="updateParams('distance', this.value)">
                        <div class="flex justify-between text-sm text-gray-500 mt-1">
                            <span>0.0001</span>
                            <span id="distance-display">0.005</span>
                            <span>0.01</span>
                        </div>
                    </div>

                    <!-- 介电常数 -->
                    <div>
                        <label for="dielectric" class="block text-gray-700 mb-2">相对介电常数 \( \varepsilon_r \)</label>
                        <select id="dielectric" class="w-full p-2 border border-gray-300 rounded-md"
                                onchange="updateParams('dielectric', this.value)">
                            <option value="1">空气 (\( \varepsilon_r = 1 \))</option>
                            <option value="2.3">纸 (\( \varepsilon_r = 2.3 \))</option>
                            <option value="3.9">陶瓷 (\( \varepsilon_r = 3.9 \))</option>
                            <option value="78">水 (\( \varepsilon_r = 78 \))</option>
                        </select>
                        <div id="dielectric-display" class="text-sm text-gray-500 mt-1">当前：空气 (\( \varepsilon_r = 1 \))</div>
                    </div>

                    <!-- 电压输入（可选，用于计算电场） -->
                    <div>
                        <label for="voltage" class="block text-gray-700 mb-2">极板电压 \( U \) (V)</label>
                        <input type="range" id="voltage" min="1" max="100" step="1" value="50" 
                               class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                               oninput="updateParams('voltage', this.value)" onchange="updateParams('voltage', this.value)">
                        <div class="flex justify-between text-sm text-gray-500 mt-1">
                            <span>1V</span>
                            <span id="voltage-display">50V</span>
                            <span>100V</span>
                        </div>
                    </div>

                    <!-- 重置按钮 -->
                    <button id="reset-btn" class="w-full bg-primary hover:bg-primary/90 text-white py-2 px-4 rounded-md transition-colors"
                            onclick="resetParams()">
                        <i class="fa-solid fa-refresh mr-1"></i> 重置参数
                    </button>
                </div>
            </div>

            <!-- 可视化区域 -->
            <div class="lg:col-span-2 space-y-6">
                <!-- 电场分布可视化 -->
                <div class="bg-white rounded-xl shadow-md p-6">
                    <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                        <i class="fa-solid fa-chart-area mr-2 text-secondary"></i> 电场分布可视化
                    </h2>
                    <div class="flex justify-center">
                        <svg id="electric-field" width="100%" height="300" class="max-w-full"></svg>
                    </div>
                </div>

                <!-- 电容与电场数值展示 -->
                <div class="bg-white rounded-xl shadow-md p-6">
                    <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                        <i class="fa-solid fa-table mr-2 text-accent"></i> 物理量计算结果
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="p-4 border border-gray-200 rounded-lg">
                            <h3 class="text-lg font-medium text-gray-700 mb-2">电容值 \( C \)</h3>
                            <p id="capacitance" class="text-2xl font-bold text-primary">35.42 pF</p>
                            <p class="text-sm text-gray-500 mt-1">公式：\( C = \frac{\varepsilon_r \varepsilon_0 S}{d} \)</p>
                        </div>
                        <div class="p-4 border border-gray-200 rounded-lg">
                            <h3 class="text-lg font-medium text-gray-700 mb-2">电场强度 \( E \)</h3>
                            <p id="electric-field-strength" class="text-2xl font-bold text-secondary">10000 V/m</p>
                            <p class="text-sm text-gray-500 mt-1">公式：\( E = \frac{U}{d} \)</p>
                        </div>
                    </div>

                    <!-- 电容变化曲线 -->
                    <div class="mt-6">
                        <h3 class="text-lg font-medium text-gray-700 mb-2">电容随参数变化趋势</h3>
                        <canvas id="capacitance-chart" width="100%" height="200"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- 应用拓展说明 -->
        <section class="bg-white rounded-xl shadow-md p-6 mt-8">
            <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                <i class="fa-solid fa-lightbulb mr-2 text-yellow-500"></i> 技术应用与拓展
            </h2>
            <p class="text-gray-700">该交互模型可用于<strong>电容传感器</strong>设计（如位移传感器、压力传感器）：通过检测电容变化反推极板间距、面积或介电常数的变化。例如，在智能康复手套中，可将电容传感器集成于手掌部位，通过握力导致的极板间距变化（弹性介质压缩），实时监测患者握力分布与大小，辅助评估手部功能恢复情况。</p>
        </section>

        <footer class="mt-12 text-center text-gray-500 text-sm">
            <p>基于HTML、JavaScript与Chart.js构建 | 物理原理可视化交互作业</p>
        </footer>
    </div>

    <script>
        // 物理常量
        const ε0 = 8.854e-12; // 真空介电常数，F/m
        let params = {
            area: 0.02,        // 极板面积，m²
            distance: 0.005,  // 极板间距，m
            dielectric: 1,    // 相对介电常数
            voltage: 50       // 极板电压，V
        };

        // 初始化图表（确保DOM加载完成后执行）
        let capacitanceChart;
        document.addEventListener('DOMContentLoaded', function() {
            initChart();
            updateVisualization();
            MathJax.typeset();
        });

        function initChart() {
            const ctx = document.getElementById('capacitance-chart').getContext('2d');
            capacitanceChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['面积减小', '默认', '面积增大', '间距减小', '默认', '间距增大', '介电常数减小', '默认', '介电常数增大'],
                    datasets: [{
                        label: '电容值 (pF)',
                        data: [],
                        borderColor: '#165DFF',
                        backgroundColor: 'rgba(22, 93, 255, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: '电容值 (pF)'
                            }
                        }
                    }
                }
            });
            updateChartData(); // 初始化图表数据
        }

        // 更新参数（实时触发）
        function updateParams(type, value) {
            if (type === 'area') {
                params.area = parseFloat(value);
                document.getElementById('area-display').textContent = params.area.toFixed(3);
            } else if (type === 'distance') {
                params.distance = parseFloat(value);
                document.getElementById('distance-display').textContent = params.distance.toFixed(4);
            } else if (type === 'dielectric') {
                params.dielectric = parseFloat(value);
                const labels = {
                    '1': '空气 (\( \varepsilon_r = 1 \))',
                    '2.3': '纸 (\( \varepsilon_r = 2.3 \))',
                    '3.9': '陶瓷 (\( \varepsilon_r = 3.9 \))',
                    '78': '水 (\( \varepsilon_r = 78 \))'
                };
                document.getElementById('dielectric-display').textContent = `当前：${labels[value]}`;
            } else if (type === 'voltage') {
                params.voltage = parseInt(value);
                document.getElementById('voltage-display').textContent = `${params.voltage}V`;
            }
            // 强制实时更新可视化
            requestAnimationFrame(updateVisualization);
            updateChartData();
            MathJax.typeset();
        }

        // 重置参数
        function resetParams() {
            document.getElementById('plate-area').value = 0.02;
            document.getElementById('plate-distance').value = 0.005;
            document.getElementById('dielectric').value = 1;
            document.getElementById('voltage').value = 50;
            updateParams('area', 0.02);
            updateParams('distance', 0.005);
            updateParams('dielectric', 1);
            updateParams('voltage', 50);
        }

        // 更新电场可视化（实时响应）
        function updateElectricField() {
            const svg = document.getElementById('electric-field');
            svg.innerHTML = ''; // 清空原有内容

            const width = svg.clientWidth;
            const height = svg.clientHeight;
            const padding = 50;
            const plateWidth = width - 2 * padding;
            const plateHeight = height * 0.6;
            const plateY = (height - plateHeight) / 2;

            // 绘制正极板（面积随参数变化）
            const positivePlate = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
            positivePlate.setAttribute('x', padding);
            positivePlate.setAttribute('y', plateY);
            // 极板宽度与面积成正比（视觉化面积变化）
            const displayPlateWidth = plateWidth * 0.45 * (params.area / 0.02);
            positivePlate.setAttribute('width', displayPlateWidth);
            positivePlate.setAttribute('height', plateHeight);
            positivePlate.setAttribute('class', '极板-正极');
            svg.appendChild(positivePlate);

            // 绘制负极板（面积随参数变化）
            const negativePlate = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
            negativePlate.setAttribute('x', width - padding - displayPlateWidth);
            negativePlate.setAttribute('y', plateY);
            negativePlate.setAttribute('width', displayPlateWidth);
            negativePlate.setAttribute('height', plateHeight);
            negativePlate.setAttribute('class', '极板-负极');
            svg.appendChild(negativePlate);

            // 电场线数量随面积变化（面积越大，电场线越多）
            const fieldLineCount = Math.floor(5 + params.area / 0.005);
            const lineSpacing = plateHeight / (fieldLineCount + 1);
            for (let i = 0; i < fieldLineCount; i++) {
                const y = plateY + (i + 1) * lineSpacing;
                const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                line.setAttribute('x1', padding + displayPlateWidth);
                line.setAttribute('y1', y);
                line.setAttribute('x2', width - padding - displayPlateWidth);
                line.setAttribute('y2', y);
                line.setAttribute('class', '电场线');
                // 电场强度越大，线越粗
                const lineThickness = 1.5 + (params.voltage / params.distance) / 10000;
                line.setAttribute('stroke-width', lineThickness);
                svg.appendChild(line);
            }

            // 绘制电场方向箭头
            const arrow = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            const arrowX = width - padding - displayPlateWidth + 10;
            const arrowY = plateY + plateHeight / 2;
            arrow.setAttribute('d', `M ${arrowX} ${arrowY-5} L ${arrowX+10} ${arrowY} L ${arrowX} ${arrowY+5} Z`);
            arrow.setAttribute('fill', '#165DFF');
            svg.appendChild(arrow);

            // 标注区域
            const regionLeft = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            regionLeft.setAttribute('x', padding - 30);
            regionLeft.setAttribute('y', plateY + plateHeight / 2);
            regionLeft.setAttribute('text-anchor', 'end');
            regionLeft.setAttribute('fill', 'gray');
            regionLeft.textContent = 'E = 0';
            svg.appendChild(regionLeft);

            const regionMiddle = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            regionMiddle.setAttribute('x', width / 2);
            regionMiddle.setAttribute('y', plateY - 20);
            regionMiddle.setAttribute('text-anchor', 'middle');
            regionMiddle.setAttribute('fill', 'gray');
            regionMiddle.textContent = `E = ${(params.voltage / params.distance).toFixed(0)} V/m`;
            svg.appendChild(regionMiddle);

            const regionRight = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            regionRight.setAttribute('x', width - padding + 30);
            regionRight.setAttribute('y', plateY + plateHeight / 2);
            regionRight.setAttribute('text-anchor', 'start');
            regionRight.setAttribute('fill', 'gray');
            regionRight.textContent = 'E = 0';
            svg.appendChild(regionRight);
        }

        // 更新数值展示（实时变化）
        function updateValues() {
            // 计算电容（转换为pF：1F = 1e12 pF）
            const capacitance = (params.dielectric * ε0 * params.area / params.distance) * 1e12;
            document.getElementById('capacitance').textContent = capacitance.toFixed(2) + ' pF';

            // 计算电场强度
            const electricField = params.voltage / params.distance;
            document.getElementById('electric-field-strength').textContent = electricField.toFixed(0) + ' V/m';
        }

        // 更新图表数据（实时同步）
        function updateChartData() {
            if (!capacitanceChart) return;

            // 实时计算不同参数下的电容值（与当前参数联动）
            const currentArea = params.area;
            const currentDistance = params.distance;
            const currentDielectric = params.dielectric;

            const data = [
                (currentDielectric * ε0 * 0.001 / currentDistance) * 1e12, // 面积减小
                (currentDielectric * ε0 * currentArea / currentDistance) * 1e12, // 当前面积
                (currentDielectric * ε0 * 0.05 / currentDistance) * 1e12, // 面积增大
                (currentDielectric * ε0 * currentArea / 0.0001) * 1e12, // 间距减小
                (currentDielectric * ε0 * currentArea / currentDistance) * 1e12, // 当前间距
                (currentDielectric * ε0 * currentArea / 0.01) * 1e12, // 间距增大
                (1 * ε0 * currentArea / currentDistance) * 1e12, // 介电常数减小
                (currentDielectric * ε0 * currentArea / currentDistance) * 1e12, // 当前介电常数
                (78 * ε0 * currentArea / currentDistance) * 1e12  // 介电常数增大
            ];
            capacitanceChart.data.datasets[0].data = data;
            capacitanceChart.update();
        }

        // 统一更新函数
        function updateVisualization() {
            updateElectricField();
            updateValues();
        }
    </script>
</body>
</html>